# ZD 2D Gunfight Game

一个完全由AI生成的2D多人射击游戏，使用Python和Pygame开发。

## 游戏特色

### 核心玩法
- **双武器系统**：支持枪械和近战武器切换
- **真实瞄准机制**：右键瞄准，视野动态变化
- **多人对战**：支持局域网多人游戏
- **房间系统**：多房间地图设计
- **实时物理**：子弹轨迹和碰撞检测

### 最新更新（参数优化版）
- **增强子弹速度**：从500提升至800，射击更爽快
- **提升移动速度**：从200提升至350，操作更流畅
- **扩展瞄准距离**：从150增加至400，视野更远
- **优化鼠标灵敏度**：从0.3提升至0.6，瞄准更精准
- **动态视野角度**：
  - 正常状态：120°广角视野
  - 瞄准状态：30°精准视野，自动切换

### 游戏控制
- **移动**：WASD
- **瞄准**：右键按住
- **射击**：左键
- **切换武器**：数字键3
- **交互**：E键（开/关门）
- **聊天**：Y键

### 管理员命令（仅限服务器端使用）
- `.weapon`：更改武器
- `.ammo`：更改弹药
- `.speed`：调整移动速度

### 技术特性
- **网络同步**：实时多人状态同步
- **视野系统**：基于角度的可见性判断
- **物理引擎**：精确的碰撞检测
- **UI系统**：完整的游戏界面和HUD

### 运行要求
- Python 3.7+
- Pygame 2.0+
- 支持Windows系统

### 启动方式
```bash
python main.py
```

### 打包方法
#### 生成Windows可执行文件
使用提供的打包脚本一键生成exe文件：
```bash
python build_exe.py
```

打包完成后，可执行文件将生成在 `dist/ZD-2D-Gunfight.exe`

#### 其他打包方法（更小体积）

##### 方法1：Nuitka编译（推荐）
使用Nuitka将Python代码编译为C++，生成更小的exe文件：
```bash
# 先安装Nuitka
pip install nuitka

# 使用Nuitka打包
python build_nuitka.py
# 选择1使用Nuitka打包
```
- **文件大小**：比PyInstaller小30-50%
- **性能优势**：原生编译，运行更快
- **输出位置**：`dist_nuitka/main.exe`

##### 方法2：最小化PyInstaller打包
使用高级优化参数排除不必要模块：
```bash
python build_minimal.py
# 选择1直接打包
```
- **文件大小**：通过排除大型库减少体积
- **优化级别**：最高优化设置
- **输出位置**：`dist_minimal/ZD-2D-Gunfight-Mini.exe`

##### 方法3：cx_Freeze打包
使用cx_Freeze作为替代打包工具：
```bash
# 先安装cx_Freeze
pip install cx_Freeze

# 使用cx_Freeze打包
python build_nuitka.py
# 选择2使用cx_Freeze
```
- **文件结构**：多文件模式，更灵活
- **输出位置**：`dist_cxfreeze/` 目录

#### 打包工具安装
一键安装所有打包工具：
```bash
python install_packaging_tools.py
# 选择1安装所有工具
```

#### 打包方法对比
| 方法 | 文件大小 | 打包时间 | 兼容性 | 推荐指数 |
|------|----------|----------|--------|----------|
| PyInstaller标准 | ~240MB | 中等 | 高 | ⭐⭐⭐ |
| PyInstaller最小化 | ~180MB | 中等 | 高 | ⭐⭐⭐⭐ |
| Nuitka | ~120MB | 较长 | 高 | ⭐⭐⭐⭐⭐ |
| cx_Freeze | ~200MB | 较短 | 中 | ⭐⭐⭐ |

#### 系统要求
- Windows 10/11
- 无需安装Python环境（已打包所有依赖）
- 存储空间：120-240MB（根据打包方法不同）

### 多人游戏

#### 服务器设置
- **启动服务器**：选择"创建服务器"
- **服务器信息**：启动后显示本地IP地址和端口
- **自动扫描**：游戏会自动扫描局域网内的可用服务器
- **最大玩家数**：支持最多10名玩家同时在线

#### 客户端连接
- **加入游戏**：选择"加入服务器"并输入IP地址
- **服务器列表**：自动显示局域网内扫描到的服务器
- **手动连接**：如果自动扫描未找到服务器，可手动输入IP地址连接
- **连接状态**：显示连接进度和错误信息

#### 详细操作指南

##### 基础移动与控制
- **WASD移动**：使用W、A、S、D键控制角色移动
- **鼠标瞄准**：移动鼠标控制瞄准方向
- **右键瞄准**：按住鼠标右键进入瞄准模式，视野变窄但更精准
- **左键射击**：点击鼠标左键发射子弹
- **数字键3**：快速切换武器（枪械/近战）

##### 武器系统详解
- **枪械武器**：
  - 弹药容量：30发
  - 装填时间：2秒
  - 射击模式：半自动
  - 有效射程：800像素

- **近战武器**：
  - 攻击范围：以角色为中心的扇形区域
  - 攻击速度：快速连击
  - 伤害类型：范围伤害
  - 使用场景：近距离战斗

##### 瞄准系统技巧
- **正常视野**：120°广角视野，适合观察周围环境
- **瞄准视野**：30°精准视野，适合远程精确射击
- **动态切换**：按住右键自动切换到瞄准模式
- **瞄准优势**：提高射击精度，增加有效射程

##### 房间与门系统
- **自动门**：靠近门时自动开启
- **手动控制**：按E键手动开关门
- **战术应用**：利用门进行掩护和伏击
- **视野阻挡**：关闭的门会阻挡视线和子弹

##### 聊天系统
- **开启聊天**：按Y键打开聊天输入框
- **发送消息**：输入消息后按Enter发送
- **玩家标识**：消息前显示玩家ID（如"玩家1: 你好"）
- **消息显示**：聊天消息在屏幕上显示一段时间后自动消失

##### 生命值与复活
- **生命值显示**：角色头顶显示绿色生命值条
- **死亡机制**：生命值归零后角色死亡
- **自动复活**：死亡后自动在出生点复活
- **复活时间**：默认5秒后复活

#### 管理员命令详解

##### 武器管理
```.weapon [武器类型]```
- **参数说明**：
  - `gun`：切换到枪械武器
  - `melee`：切换到近战武器
- **使用示例**：`.weapon gun` - 将当前武器切换为枪械

##### 弹药管理
```.ammo [数量]```
- **参数说明**：设置当前弹药的数值
- **数值范围**：0-30
- **使用示例**：`.ammo 30` - 将弹药设置为满状态

##### 速度调整
```.speed [速度值]```
- **参数说明**：调整角色移动速度
- **默认速度**：350
- **推荐范围**：100-500
- **使用示例**：`.speed 500` - 将移动速度提升到最大

##### 玩家踢出
```.kick [玩家ID]```
- **参数说明**：将指定玩家从服务器中踢出
- **玩家ID格式**：数字ID（如1、2、3等）
- **权限要求**：仅服务器管理员可使用
- **使用示例**：`.kick 2` - 将玩家2从游戏中踢出
- **注意事项**：
  - 踢出玩家后，该玩家将立即断开连接
  - 被踢出的玩家无法重新连接，除非管理员邀请
  - 请谨慎使用此命令，避免误踢正常玩家

#### 游戏技巧与策略

##### 战斗技巧
- **利用掩护**：使用墙壁和门作为掩护
- **瞄准射击**：远距离时使用瞄准模式提高精度
- **近战优势**：近距离时切换到近战武器更有效
- **移动射击**：移动时射击避免成为固定目标

##### 团队配合
- **信息共享**：使用聊天系统分享敌人位置
- **协同攻击**：多方向攻击同一目标
- **掩护队友**：为队友提供火力掩护
- **资源分配**：合理分配武器和弹药

##### 地图利用
- **房间控制**：控制关键房间获得战略优势
- **门的使用**：合理使用门进行防守和突袭
- **视野管理**：利用视野系统隐藏行踪
- **声音提示**：注意脚步声等声音信息

#### 常见问题解答

##### 连接问题
**Q: 无法连接到服务器怎么办？**
A: 请检查以下几点：
- 确保服务器已启动并显示正确的IP地址
- 检查网络连接，确保在同一局域网内
- 确认防火墙设置，允许游戏通过防火墙
- 尝试手动输入IP地址而不是使用自动扫描

**Q: 扫描不到局域网服务器？**
A: 可能的原因：
- 服务器和客户端不在同一网段
- 网络设备阻止了UDP广播
- 防火墙阻止了扫描请求
- 解决方法：使用"刷新服务器列表"或手动输入IP

##### 游戏操作问题
**Q: 瞄准时视野为什么会变窄？**
A: 这是游戏的瞄准机制设计，按住右键进入瞄准模式会：
- 将视野角度从120°缩小到30°
- 提高射击精度
- 增加有效射程
- 模拟真实瞄准体验

**Q: 如何快速切换武器？**
A: 使用数字键3可以快速在枪械和近战武器之间切换：
- 枪械适合中远距离战斗
- 近战武器适合近距离高伤害
- 根据战斗情况灵活选择

##### 性能问题
**Q: 游戏运行卡顿怎么办？**
A: 尝试以下优化方法：
- 关闭其他占用资源的程序
- 降低游戏分辨率设置
- 确保显卡驱动是最新的
- 使用打包的exe文件运行而非Python脚本

**Q: 网络延迟高怎么办？**
A: 网络优化建议：
- 使用有线网络连接
- 确保服务器和客户端网络稳定
- 避免在网络繁忙时段游戏
- 减少同时连接的玩家数量